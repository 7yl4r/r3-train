<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Lesson 2 Manipulate: tidyr, dplyr | Reproducible Reporting with R (R³) for marine ecosystem indicators</title>
  <meta name="description" content="These materials are for a 1-day workshop on Reproducible Reporting with R for the Working Group on the Northwest Atlantic Regional Sea (WGNARS) at Dartmouth SMAST on March 16, 2020. The output format is using bookdown::gitbook()." />
  <meta name="generator" content="bookdown 0.21.2 and GitBook 2.6.7" />

  <meta property="og:title" content="Lesson 2 Manipulate: tidyr, dplyr | Reproducible Reporting with R (R³) for marine ecosystem indicators" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="These materials are for a 1-day workshop on Reproducible Reporting with R for the Working Group on the Northwest Atlantic Regional Sea (WGNARS) at Dartmouth SMAST on March 16, 2020. The output format is using bookdown::gitbook()." />
  <meta name="github-repo" content="ecoquants/nps-r-workshop" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Lesson 2 Manipulate: tidyr, dplyr | Reproducible Reporting with R (R³) for marine ecosystem indicators" />
  
  <meta name="twitter:description" content="These materials are for a 1-day workshop on Reproducible Reporting with R for the Working Group on the Northwest Atlantic Regional Sea (WGNARS) at Dartmouth SMAST on March 16, 2020. The output format is using bookdown::gitbook()." />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="collaborate-git-github.html"/>
<link rel="next" href="visualize-ggplot2-plotly-tmap.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>
<script src="libs/d3-3.5.5/d3.min.js"></script>
<script src="libs/d3-tip-0.6.7/d3-tip.js"></script>
<link href="libs/d3_exploding_boxplot-0.1/d3_exploding_boxplot.css" rel="stylesheet" />
<script src="libs/d3_exploding_boxplot-0.1/d3_exploding_boxplot.js"></script>
<script src="libs/exploding-boxplot-binding-0.0.1/exploding-boxplot.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>
<script src="libs/FlatGeoBuf-3.3.3/fgb.js"></script>
<script src="libs/FlatGeoBuf-3.3.3/flatgeobuf-geojson.min.js"></script>
<script src="libs/chromajs-2.1.0/chroma.min.js"></script>
<link id="states-1-attachment" rel="attachment" href="libs/states-0.0.1/states_layer.fgb"/>
<link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />
<link id="AL-1-attachment" rel="attachment" href="libs/AL-0.0.1/AL_layer.fgb"/>
<link id="AR-1-attachment" rel="attachment" href="libs/AR-0.0.1/AR_layer.fgb"/>
<link id="AZ-1-attachment" rel="attachment" href="libs/AZ-0.0.1/AZ_layer.fgb"/>
<link id="CA-1-attachment" rel="attachment" href="libs/CA-0.0.1/CA_layer.fgb"/>
<link id="CO-1-attachment" rel="attachment" href="libs/CO-0.0.1/CO_layer.fgb"/>
<link id="CT-1-attachment" rel="attachment" href="libs/CT-0.0.1/CT_layer.fgb"/>
<link id="DC-1-attachment" rel="attachment" href="libs/DC-0.0.1/DC_layer.fgb"/>
<link id="DE-1-attachment" rel="attachment" href="libs/DE-0.0.1/DE_layer.fgb"/>
<link id="FL-1-attachment" rel="attachment" href="libs/FL-0.0.1/FL_layer.fgb"/>
<link id="GA-1-attachment" rel="attachment" href="libs/GA-0.0.1/GA_layer.fgb"/>
<link id="IA-1-attachment" rel="attachment" href="libs/IA-0.0.1/IA_layer.fgb"/>
<link id="ID-1-attachment" rel="attachment" href="libs/ID-0.0.1/ID_layer.fgb"/>
<link id="IL-1-attachment" rel="attachment" href="libs/IL-0.0.1/IL_layer.fgb"/>
<link id="IN-1-attachment" rel="attachment" href="libs/IN-0.0.1/IN_layer.fgb"/>
<link id="KS-1-attachment" rel="attachment" href="libs/KS-0.0.1/KS_layer.fgb"/>
<link id="KY-1-attachment" rel="attachment" href="libs/KY-0.0.1/KY_layer.fgb"/>
<link id="LA-1-attachment" rel="attachment" href="libs/LA-0.0.1/LA_layer.fgb"/>
<link id="MA-1-attachment" rel="attachment" href="libs/MA-0.0.1/MA_layer.fgb"/>
<link id="MD-1-attachment" rel="attachment" href="libs/MD-0.0.1/MD_layer.fgb"/>
<link id="ME-1-attachment" rel="attachment" href="libs/ME-0.0.1/ME_layer.fgb"/>
<link id="MI-1-attachment" rel="attachment" href="libs/MI-0.0.1/MI_layer.fgb"/>
<link id="MN-1-attachment" rel="attachment" href="libs/MN-0.0.1/MN_layer.fgb"/>
<link id="MO-1-attachment" rel="attachment" href="libs/MO-0.0.1/MO_layer.fgb"/>
<link id="MS-1-attachment" rel="attachment" href="libs/MS-0.0.1/MS_layer.fgb"/>
<link id="MT-1-attachment" rel="attachment" href="libs/MT-0.0.1/MT_layer.fgb"/>
<link id="NC-1-attachment" rel="attachment" href="libs/NC-0.0.1/NC_layer.fgb"/>
<link id="ND-1-attachment" rel="attachment" href="libs/ND-0.0.1/ND_layer.fgb"/>
<link id="NE-1-attachment" rel="attachment" href="libs/NE-0.0.1/NE_layer.fgb"/>
<link id="NH-1-attachment" rel="attachment" href="libs/NH-0.0.1/NH_layer.fgb"/>
<link id="NJ-1-attachment" rel="attachment" href="libs/NJ-0.0.1/NJ_layer.fgb"/>
<link id="NM-1-attachment" rel="attachment" href="libs/NM-0.0.1/NM_layer.fgb"/>
<link id="NV-1-attachment" rel="attachment" href="libs/NV-0.0.1/NV_layer.fgb"/>
<link id="NY-1-attachment" rel="attachment" href="libs/NY-0.0.1/NY_layer.fgb"/>
<link id="OH-1-attachment" rel="attachment" href="libs/OH-0.0.1/OH_layer.fgb"/>
<link id="OK-1-attachment" rel="attachment" href="libs/OK-0.0.1/OK_layer.fgb"/>
<link id="OR-1-attachment" rel="attachment" href="libs/OR-0.0.1/OR_layer.fgb"/>
<link id="PA-1-attachment" rel="attachment" href="libs/PA-0.0.1/PA_layer.fgb"/>
<link id="RI-1-attachment" rel="attachment" href="libs/RI-0.0.1/RI_layer.fgb"/>
<link id="SC-1-attachment" rel="attachment" href="libs/SC-0.0.1/SC_layer.fgb"/>
<link id="SD-1-attachment" rel="attachment" href="libs/SD-0.0.1/SD_layer.fgb"/>
<link id="TN-1-attachment" rel="attachment" href="libs/TN-0.0.1/TN_layer.fgb"/>
<link id="TX-1-attachment" rel="attachment" href="libs/TX-0.0.1/TX_layer.fgb"/>
<link id="UT-1-attachment" rel="attachment" href="libs/UT-0.0.1/UT_layer.fgb"/>
<link id="VA-1-attachment" rel="attachment" href="libs/VA-0.0.1/VA_layer.fgb"/>
<link id="VT-1-attachment" rel="attachment" href="libs/VT-0.0.1/VT_layer.fgb"/>
<link id="WA-1-attachment" rel="attachment" href="libs/WA-0.0.1/WA_layer.fgb"/>
<link id="WI-1-attachment" rel="attachment" href="libs/WI-0.0.1/WI_layer.fgb"/>
<link id="WV-1-attachment" rel="attachment" href="libs/WV-0.0.1/WV_layer.fgb"/>
<link id="WY-1-attachment" rel="attachment" href="libs/WY-0.0.1/WY_layer.fgb"/>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="style/style.css" type="text/css" />
<link rel="stylesheet" href="style/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R3 Workshop</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#github"><i class="fa fa-check"></i>Github</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#google-drive"><i class="fa fa-check"></i>Google Drive</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#resources"><i class="fa fa-check"></i>Resources</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-setup"><i class="fa fa-check"></i>Software Setup</a></li>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#install-software"><i class="fa fa-check"></i><b>0.1</b> Install software</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#launch-rstudio"><i class="fa fa-check"></i><b>0.2</b> Launch RStudio</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#fork-and-clone-the-github-repository"><i class="fa fa-check"></i><b>0.3</b> Fork and Clone the Github Repository</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#install-r-packages"><i class="fa fa-check"></i><b>0.4</b> Install R Packages</a></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#create-rmarkdown-file"><i class="fa fa-check"></i><b>0.5</b> Create Rmarkdown file</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="collaborate-git-github.html"><a href="collaborate-git-github.html"><i class="fa fa-check"></i><b>1</b> Collaborate: git, github</a><ul>
<li class="chapter" data-level="1.1" data-path="collaborate-git-github.html"><a href="collaborate-git-github.html#setup-github-git"><i class="fa fa-check"></i><b>1.1</b> Setup Github &amp; Git</a></li>
<li class="chapter" data-level="1.2" data-path="collaborate-git-github.html"><a href="collaborate-git-github.html#github-workflows"><i class="fa fa-check"></i><b>1.2</b> Github Workflows</a><ul>
<li class="chapter" data-level="1.2.1" data-path="collaborate-git-github.html"><a href="collaborate-git-github.html#push-pull"><i class="fa fa-check"></i><b>1.2.1</b> Push &amp; Pull</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="collaborate-git-github.html"><a href="collaborate-git-github.html#create-repository-nps-demo"><i class="fa fa-check"></i><b>1.3</b> Create Repository <code>nps-demo</code></a><ul>
<li class="chapter" data-level="1.3.1" data-path="collaborate-git-github.html"><a href="collaborate-git-github.html#edit-readme.md-in-markdown"><i class="fa fa-check"></i><b>1.3.1</b> Edit <code>README.md</code> in Markdown</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="collaborate-git-github.html"><a href="collaborate-git-github.html#create-index.html"><i class="fa fa-check"></i><b>1.4</b> Create <code>index.html</code></a></li>
<li class="chapter" data-level="1.5" data-path="collaborate-git-github.html"><a href="collaborate-git-github.html#create-rstudio-project-with-git-repository"><i class="fa fa-check"></i><b>1.5</b> Create RStudio Project with Git Repository</a></li>
<li class="chapter" data-level="1.6" data-path="collaborate-git-github.html"><a href="collaborate-git-github.html#create-index.rmd-in-rmarkdown"><i class="fa fa-check"></i><b>1.6</b> Create <code>index.Rmd</code> in Rmarkdown</a></li>
<li class="chapter" data-level="1.7" data-path="collaborate-git-github.html"><a href="collaborate-git-github.html#exercise-intertidal-sites-dataset"><i class="fa fa-check"></i><b>1.7</b> Exercise: Intertidal Sites Dataset</a><ul>
<li class="chapter" data-level="1.7.1" data-path="collaborate-git-github.html"><a href="collaborate-git-github.html#task-provide-excel-cell-ranges-for-how-you-would-divide-data-into-tables"><i class="fa fa-check"></i><b>1.7.1</b> Task: Provide Excel cell ranges for how you would divide data into tables?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="manipulate-tidyr-dplyr.html"><a href="manipulate-tidyr-dplyr.html"><i class="fa fa-check"></i><b>2</b> Manipulate: <code>tidyr</code>, <code>dplyr</code></a><ul>
<li class="chapter" data-level="2.1" data-path="manipulate-tidyr-dplyr.html"><a href="manipulate-tidyr-dplyr.html#install-our-first-package-dplyr"><i class="fa fa-check"></i><b>2.1</b> install our first package: <code>dplyr</code></a></li>
<li class="chapter" data-level="2.2" data-path="manipulate-tidyr-dplyr.html"><a href="manipulate-tidyr-dplyr.html#use-dplyrfilter-to-subset-data-row-wise."><i class="fa fa-check"></i><b>2.2</b> Use <code>dplyr::filter()</code> to subset data row-wise.</a></li>
<li class="chapter" data-level="2.3" data-path="manipulate-tidyr-dplyr.html"><a href="manipulate-tidyr-dplyr.html#meet-the-new-pipe-operator"><i class="fa fa-check"></i><b>2.3</b> Meet the new pipe operator</a></li>
<li class="chapter" data-level="2.4" data-path="manipulate-tidyr-dplyr.html"><a href="manipulate-tidyr-dplyr.html#use-dplyrselect-to-subset-the-data-on-variables-or-columns."><i class="fa fa-check"></i><b>2.4</b> Use <code>dplyr::select()</code> to subset the data on variables or columns.</a></li>
<li class="chapter" data-level="2.5" data-path="manipulate-tidyr-dplyr.html"><a href="manipulate-tidyr-dplyr.html#revel-in-the-convenience"><i class="fa fa-check"></i><b>2.5</b> Revel in the convenience</a></li>
<li class="chapter" data-level="2.6" data-path="manipulate-tidyr-dplyr.html"><a href="manipulate-tidyr-dplyr.html#use-mutate-to-add-new-variables"><i class="fa fa-check"></i><b>2.6</b> Use <code>mutate()</code> to add new variables</a></li>
<li class="chapter" data-level="2.7" data-path="manipulate-tidyr-dplyr.html"><a href="manipulate-tidyr-dplyr.html#group_by-and-summarize"><i class="fa fa-check"></i><b>2.7</b> <code>group_by</code> and <code>summarize</code></a></li>
<li class="chapter" data-level="2.8" data-path="manipulate-tidyr-dplyr.html"><a href="manipulate-tidyr-dplyr.html#remember-our-for-loop"><i class="fa fa-check"></i><b>2.8</b> Remember our for loop?</a></li>
<li class="chapter" data-level="2.9" data-path="manipulate-tidyr-dplyr.html"><a href="manipulate-tidyr-dplyr.html#summary"><i class="fa fa-check"></i><b>2.9</b> Summary</a></li>
<li class="chapter" data-level="2.10" data-path="manipulate-tidyr-dplyr.html"><a href="manipulate-tidyr-dplyr.html#further-materials-as-reference"><i class="fa fa-check"></i><b>2.10</b> Further materials as reference…</a><ul>
<li class="chapter" data-level="2.10.1" data-path="manipulate-tidyr-dplyr.html"><a href="manipulate-tidyr-dplyr.html#rationale"><i class="fa fa-check"></i><b>2.10.1</b> Rationale</a></li>
<li class="chapter" data-level="2.10.2" data-path="manipulate-tidyr-dplyr.html"><a href="manipulate-tidyr-dplyr.html#pseudocode"><i class="fa fa-check"></i><b>2.10.2</b> Pseudocode</a></li>
<li class="chapter" data-level="2.10.3" data-path="manipulate-tidyr-dplyr.html"><a href="manipulate-tidyr-dplyr.html#summary-1"><i class="fa fa-check"></i><b>2.10.3</b> Summary</a></li>
<li class="chapter" data-level="2.10.4" data-path="manipulate-tidyr-dplyr.html"><a href="manipulate-tidyr-dplyr.html#dplyr"><i class="fa fa-check"></i><b>2.10.4</b> <code>dplyr</code></a></li>
<li class="chapter" data-level="2.10.5" data-path="manipulate-tidyr-dplyr.html"><a href="manipulate-tidyr-dplyr.html#tidyr"><i class="fa fa-check"></i><b>2.10.5</b> <code>tidyr</code></a></li>
<li class="chapter" data-level="2.10.6" data-path="manipulate-tidyr-dplyr.html"><a href="manipulate-tidyr-dplyr.html#other-links"><i class="fa fa-check"></i><b>2.10.6</b> Other links</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="visualize-ggplot2-plotly-tmap.html"><a href="visualize-ggplot2-plotly-tmap.html"><i class="fa fa-check"></i><b>3</b> Visualize: <code>ggplot2</code>, <code>plotly</code>, <code>tmap</code></a><ul>
<li class="chapter" data-level="3.1" data-path="visualize-ggplot2-plotly-tmap.html"><a href="visualize-ggplot2-plotly-tmap.html#plot"><i class="fa fa-check"></i><b>3.1</b> Plot</a><ul>
<li class="chapter" data-level="3.1.1" data-path="visualize-ggplot2-plotly-tmap.html"><a href="visualize-ggplot2-plotly-tmap.html#static-ggplot"><i class="fa fa-check"></i><b>3.1.1</b> Static: <code>ggplot</code></a></li>
<li class="chapter" data-level="3.1.2" data-path="visualize-ggplot2-plotly-tmap.html"><a href="visualize-ggplot2-plotly-tmap.html#interactive-plotly"><i class="fa fa-check"></i><b>3.1.2</b> Interactive: <code>plotly</code></a></li>
<li class="chapter" data-level="3.1.3" data-path="visualize-ggplot2-plotly-tmap.html"><a href="visualize-ggplot2-plotly-tmap.html#interactive-exploding-boxplot"><i class="fa fa-check"></i><b>3.1.3</b> Interactive: Exploding Boxplot</a></li>
<li class="chapter" data-level="3.1.4" data-path="visualize-ggplot2-plotly-tmap.html"><a href="visualize-ggplot2-plotly-tmap.html#interactive-motion-plot"><i class="fa fa-check"></i><b>3.1.4</b> Interactive: Motion Plot</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="visualize-ggplot2-plotly-tmap.html"><a href="visualize-ggplot2-plotly-tmap.html#map"><i class="fa fa-check"></i><b>3.2</b> Map</a><ul>
<li class="chapter" data-level="3.2.1" data-path="visualize-ggplot2-plotly-tmap.html"><a href="visualize-ggplot2-plotly-tmap.html#static"><i class="fa fa-check"></i><b>3.2.1</b> Static</a></li>
<li class="chapter" data-level="3.2.2" data-path="visualize-ggplot2-plotly-tmap.html"><a href="visualize-ggplot2-plotly-tmap.html#interactive"><i class="fa fa-check"></i><b>3.2.2</b> Interactive</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="visualize-ggplot2-plotly-tmap.html"><a href="visualize-ggplot2-plotly-tmap.html#references"><i class="fa fa-check"></i><b>3.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="analyze-spatial-sf.html"><a href="analyze-spatial-sf.html"><i class="fa fa-check"></i><b>4</b> Analyze Spatial: <code>sf</code></a><ul>
<li class="chapter" data-level="4.1" data-path="analyze-spatial-sf.html"><a href="analyze-spatial-sf.html#overview-1"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="analyze-spatial-sf.html"><a href="analyze-spatial-sf.html#prerequisites"><i class="fa fa-check"></i><b>4.2</b> Prerequisites</a></li>
<li class="chapter" data-level="4.3" data-path="analyze-spatial-sf.html"><a href="analyze-spatial-sf.html#states-read-and-plot"><i class="fa fa-check"></i><b>4.3</b> States: read and plot</a></li>
<li class="chapter" data-level="4.4" data-path="analyze-spatial-sf.html"><a href="analyze-spatial-sf.html#challenge-analytical-steps"><i class="fa fa-check"></i><b>4.4</b> Challenge: analytical steps?</a><ul>
<li class="chapter" data-level="4.4.1" data-path="analyze-spatial-sf.html"><a href="analyze-spatial-sf.html#answers"><i class="fa fa-check"></i><b>4.4.1</b> Answers</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="analyze-spatial-sf.html"><a href="analyze-spatial-sf.html#regions-calculate-water"><i class="fa fa-check"></i><b>4.5</b> Regions: calculate % water</a></li>
<li class="chapter" data-level="4.6" data-path="analyze-spatial-sf.html"><a href="analyze-spatial-sf.html#regions-plot"><i class="fa fa-check"></i><b>4.6</b> Regions: plot</a></li>
<li class="chapter" data-level="4.7" data-path="analyze-spatial-sf.html"><a href="analyze-spatial-sf.html#regions-ggplot"><i class="fa fa-check"></i><b>4.7</b> Regions: ggplot</a></li>
<li class="chapter" data-level="4.8" data-path="analyze-spatial-sf.html"><a href="analyze-spatial-sf.html#regions-recalculate-area"><i class="fa fa-check"></i><b>4.8</b> Regions: recalculate area</a></li>
<li class="chapter" data-level="4.9" data-path="analyze-spatial-sf.html"><a href="analyze-spatial-sf.html#challenge-project-recalculate-area"><i class="fa fa-check"></i><b>4.9</b> Challenge: project &amp; recalculate area</a><ul>
<li class="chapter" data-level="4.9.1" data-path="analyze-spatial-sf.html"><a href="analyze-spatial-sf.html#answers-1"><i class="fa fa-check"></i><b>4.9.1</b> Answers</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="analyze-spatial-sf.html"><a href="analyze-spatial-sf.html#key-points"><i class="fa fa-check"></i><b>4.10</b> Key Points</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="interactive-map-leaflet.html"><a href="interactive-map-leaflet.html"><i class="fa fa-check"></i><b>5</b> Interactive Map: <code>leaflet</code></a><ul>
<li class="chapter" data-level="5.1" data-path="interactive-map-leaflet.html"><a href="interactive-map-leaflet.html#overview-2"><i class="fa fa-check"></i><b>5.1</b> Overview</a></li>
<li class="chapter" data-level="5.2" data-path="interactive-map-leaflet.html"><a href="interactive-map-leaflet.html#things-youll-need-to-complete-this-tutorial"><i class="fa fa-check"></i><b>5.2</b> Things You’ll Need to Complete this Tutorial</a></li>
<li class="chapter" data-level="5.3" data-path="interactive-map-leaflet.html"><a href="interactive-map-leaflet.html#states-ggplot2"><i class="fa fa-check"></i><b>5.3</b> States: ggplot2</a></li>
<li class="chapter" data-level="5.4" data-path="interactive-map-leaflet.html"><a href="interactive-map-leaflet.html#states-plotly"><i class="fa fa-check"></i><b>5.4</b> States: plotly</a></li>
<li class="chapter" data-level="5.5" data-path="interactive-map-leaflet.html"><a href="interactive-map-leaflet.html#states-mapview"><i class="fa fa-check"></i><b>5.5</b> States: mapview</a></li>
<li class="chapter" data-level="5.6" data-path="interactive-map-leaflet.html"><a href="interactive-map-leaflet.html#states-leaflet"><i class="fa fa-check"></i><b>5.6</b> States: leaflet</a><ul>
<li class="chapter" data-level="5.6.1" data-path="interactive-map-leaflet.html"><a href="interactive-map-leaflet.html#choropleth"><i class="fa fa-check"></i><b>5.6.1</b> Choropleth</a></li>
<li class="chapter" data-level="5.6.2" data-path="interactive-map-leaflet.html"><a href="interactive-map-leaflet.html#popups-and-legend"><i class="fa fa-check"></i><b>5.6.2</b> Popups and Legend</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="interactive-map-leaflet.html"><a href="interactive-map-leaflet.html#challenge-leaflet-for-regions"><i class="fa fa-check"></i><b>5.7</b> Challenge: leaflet for regions</a><ul>
<li class="chapter" data-level="5.7.1" data-path="interactive-map-leaflet.html"><a href="interactive-map-leaflet.html#answers-2"><i class="fa fa-check"></i><b>5.7.1</b> Answers</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="interactive-map-leaflet.html"><a href="interactive-map-leaflet.html#raster-leaflet"><i class="fa fa-check"></i><b>5.8</b> Raster: leaflet</a></li>
<li class="chapter" data-level="5.9" data-path="interactive-map-leaflet.html"><a href="interactive-map-leaflet.html#key-points-1"><i class="fa fa-check"></i><b>5.9</b> Key Points</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="shiny-google-authentication.html"><a href="shiny-google-authentication.html"><i class="fa fa-check"></i><b>A</b> Shiny: Google Authentication</a><ul>
<li class="chapter" data-level="A.1" data-path="shiny-google-authentication.html"><a href="shiny-google-authentication.html#quick-sign-in-google-sign-in"><i class="fa fa-check"></i><b>A.1</b> Quick Sign-In (<code>Google-Sign-In</code>)</a><ul>
<li class="chapter" data-level="A.1.1" data-path="shiny-google-authentication.html"><a href="shiny-google-authentication.html#errors"><i class="fa fa-check"></i><b>A.1.1</b> Errors</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="shiny-google-authentication.html"><a href="shiny-google-authentication.html#setting-up-for-server"><i class="fa fa-check"></i><b>A.2</b> Setting up for Server</a></li>
<li class="chapter" data-level="A.3" data-path="shiny-google-authentication.html"><a href="shiny-google-authentication.html#complex-sign-in-googleauthr"><i class="fa fa-check"></i><b>A.3</b> Complex Sign-In (<code>googleAuthR</code>)</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Reproducible Reporting with R (R³) for marine ecosystem indicators</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="manipulate-tidyr-dplyr" class="section level1">
<h1><span class="header-section-number">Lesson 2</span> Manipulate: <code>tidyr</code>, <code>dplyr</code></h1>
<blockquote>
<p>Data scientists, according to interviews and expert estimates, spend from 50 percent to 80 percent of their time mired in the mundane labor of collecting and preparing data, before it can be explored for useful information. - <a href="http://www.nytimes.com/2014/08/18/technology/for-big-data-scientists-hurdle-to-insights-is-janitor-work.html">NYTimes (2014)</a></p>
</blockquote>
<p>Today we’re going to learn about a package by Hadley Wickham called <code>dplyr</code> and how it will help you with simple data exploration, and how you can use it in combination with the <code>%&gt;%</code> operator for more complex wrangling (including a lot of the things you would use for loops for.</p>
<p>And we’re going to do this in Rmarkdown in the <code>my-project</code> repository we created this morning.</p>
<p>Here are the steps:</p>
<ol style="list-style-type: decimal">
<li>Open RStudio</li>
<li>Make sure you’re in your <code>my-project</code> repo (and if not, get there)</li>
<li>New &gt; Rmarkdown… (defaults are fine)</li>
<li>Save as <code>gapminder-dplyr.rmd</code></li>
<li>Our workflow together will be to write some description of our analysis in Markdown for humans to read, and we will write all of our R code in the ‘chunks’. Get ready for the awesomeness, here we go…</li>
</ol>
<p>Today’s materials are again borrowing from some excellent sources, including</p>
<ul>
<li>Dr. Jenny Bryan’s lectures from STAT545 at UBC: <a href="http://stat545.com/block009_dplyr-intro.html">Introduction to dplyr</a></li>
<li>Software Carpentry’s R for reproducible scientific analysis materials: <a href="http://swcarpentry.github.io/r-novice-gapminder/13-dplyr.html">Dataframe manipulation with dplyr</a></li>
</ul>
<div id="install-our-first-package-dplyr" class="section level2">
<h2><span class="header-section-number">2.1</span> install our first package: <code>dplyr</code></h2>
<p>Packages are bundles of functions, along with help pages and other goodies that make them easier for others to use, (ie. vignettes).</p>
<p>So far we’ve been using packages included in ‘base R’; they are ‘out-of-the-box’ functions. You can also install packages from online. The most traditional is <a href="https://cran.r-project.org/">CRAN, the Comprehensive R Archive Network</a>. This is where you went to download R originally, and will go again to look for updates.</p>
<p>You don’t need to go to CRAN’s website to install packages, we can do it from within R with the command <code>install.packages("package-name-in-quotes")</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="manipulate-tidyr-dplyr.html#cb5-1"></a><span class="co">## from CRAN:</span></span>
<span id="cb5-2"><a href="manipulate-tidyr-dplyr.html#cb5-2"></a><span class="co">#install.packages(&quot;dplyr&quot;) ## do this once only to install the package on your computer.</span></span>
<span id="cb5-3"><a href="manipulate-tidyr-dplyr.html#cb5-3"></a></span>
<span id="cb5-4"><a href="manipulate-tidyr-dplyr.html#cb5-4"></a><span class="kw">library</span>(dplyr) <span class="co">## do this every time you restart R and need it</span></span>
<span id="cb5-5"><a href="manipulate-tidyr-dplyr.html#cb5-5"></a>select &lt;-<span class="st"> </span>dplyr<span class="op">::</span>select <span class="co"># overwrite raster::select</span></span></code></pre></div>
<p>What’s the difference between <code>install.packages()</code> and <code>library()</code>? Here’s my analogy:</p>
<ul>
<li><code>install.packages()</code> is setting up electricity for your house. Just need to do this once (let’s ignore monthly bills).</li>
<li><code>library()</code> is turning on the lights. You only turn them on when you need them, otherwise it wouldn’t be efficient. And when you quit R, and come back, you’ll have to turn them on again with <code>library()</code>, but you already have your electricity set up.</li>
</ul>
</div>
<div id="use-dplyrfilter-to-subset-data-row-wise." class="section level2">
<h2><span class="header-section-number">2.2</span> Use <code>dplyr::filter()</code> to subset data row-wise.</h2>
<p>First let’s read in the gapminder data.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="manipulate-tidyr-dplyr.html#cb6-1"></a><span class="co"># install.packages(&#39;gapminder&#39;) # instead of reading in the csv</span></span>
<span id="cb6-2"><a href="manipulate-tidyr-dplyr.html#cb6-2"></a><span class="kw">library</span>(gapminder) <span class="co"># this is the package name</span></span>
<span id="cb6-3"><a href="manipulate-tidyr-dplyr.html#cb6-3"></a><span class="kw">str</span>(gapminder) <span class="co"># and it&#39;s also the data.frame name, just like yesterday</span></span></code></pre></div>
<pre><code>## tibble [1,704 × 6] (S3: tbl_df/tbl/data.frame)
##  $ country  : Factor w/ 142 levels &quot;Afghanistan&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ continent: Factor w/ 5 levels &quot;Africa&quot;,&quot;Americas&quot;,..: 3 3 3 3 3 3 3 3 3 3 ...
##  $ year     : int [1:1704] 1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 ...
##  $ lifeExp  : num [1:1704] 28.8 30.3 32 34 36.1 ...
##  $ pop      : int [1:1704] 8425333 9240934 10267083 11537966 13079460 14880372 12881816 13867957 16317921 22227415 ...
##  $ gdpPercap: num [1:1704] 779 821 853 836 740 ...</code></pre>
<p><code>filter()</code> takes logical expressions and returns the rows for which all are <code>TRUE</code>. Visually, we are doing this (thanks RStudio for your <a href="http://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf">cheatsheet</a>):</p>
<p><img src="figs/rstudio-cheatsheet-filter.png" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="manipulate-tidyr-dplyr.html#cb8-1"></a><span class="kw">filter</span>(gapminder, lifeExp <span class="op">&lt;</span><span class="st"> </span><span class="dv">29</span>)</span>
<span id="cb8-2"><a href="manipulate-tidyr-dplyr.html#cb8-2"></a><span class="kw">filter</span>(gapminder, country <span class="op">==</span><span class="st"> &quot;Rwanda&quot;</span>)</span>
<span id="cb8-3"><a href="manipulate-tidyr-dplyr.html#cb8-3"></a><span class="kw">filter</span>(gapminder, country <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Rwanda&quot;</span>, <span class="st">&quot;Afghanistan&quot;</span>))</span></code></pre></div>
<p>Compare with some base R code to accomplish the same things</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="manipulate-tidyr-dplyr.html#cb9-1"></a>gapminder[gapminder<span class="op">$</span>lifeExp <span class="op">&lt;</span><span class="st"> </span><span class="dv">29</span>, ] <span class="co">## repeat `gapminder`, [i, j] indexing is distracting</span></span>
<span id="cb9-2"><a href="manipulate-tidyr-dplyr.html#cb9-2"></a><span class="kw">subset</span>(gapminder, country <span class="op">==</span><span class="st"> &quot;Rwanda&quot;</span>) <span class="co">## almost same as filter ... but wait ...</span></span></code></pre></div>
</div>
<div id="meet-the-new-pipe-operator" class="section level2">
<h2><span class="header-section-number">2.3</span> Meet the new pipe operator</h2>
<p>Before we go any further, we should exploit the new pipe operator that <code>dplyr</code> imports from the <a href="https://github.com/smbache/magrittr"><code>magrittr</code></a> package by Stefan Bache. <strong>This is going to change your data analytical life</strong>. You no longer need to enact multi-operation commands by nesting them inside each other. This new syntax leads to code that is much easier to write and to read.</p>
<p>Here’s what it looks like: <code>%&gt;%</code>. The RStudio keyboard shortcut: Ctrl + Shift + M (Windows), Cmd + Shift + M (Mac).</p>
<p>Let’s demo then I’ll explain:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="manipulate-tidyr-dplyr.html#cb10-1"></a>gapminder <span class="op">%&gt;%</span><span class="st"> </span>head</span></code></pre></div>
<p>This is equivalent to <code>head(gapminder)</code>. This pipe operator takes the thing on the left-hand-side and <strong>pipes</strong> it into the function call on the right-hand-side – literally, drops it in as the first argument.</p>
<p>Never fear, you can still specify other arguments to this function! To see the first 3 rows of Gapminder, we could say <code>head(gapminder, 3)</code> or this:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="manipulate-tidyr-dplyr.html#cb11-1"></a>gapminder <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">3</span>)</span></code></pre></div>
<p><strong>I’ve advised you to think “gets” whenever you see the assignment operator, <code>&lt;-</code>. Similary, you should think “then” whenever you see the pipe operator, <code>%&gt;%</code>.</strong></p>
<p>You are probably not impressed yet, but the magic will soon happen.</p>
</div>
<div id="use-dplyrselect-to-subset-the-data-on-variables-or-columns." class="section level2">
<h2><span class="header-section-number">2.4</span> Use <code>dplyr::select()</code> to subset the data on variables or columns.</h2>
<p>Back to <code>dplyr</code> …</p>
<p>Use <code>select()</code> to subset the data on variables or columns. Visually, we are doing this (thanks RStudio for your <a href="http://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf">cheatsheet</a>):</p>
<p><img src="figs/rstudio-cheatsheet-select.png" /></p>
<p>Here’s a conventional call:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="manipulate-tidyr-dplyr.html#cb12-1"></a><span class="kw">select</span>(gapminder, year, lifeExp) </span></code></pre></div>
<p>But using what we just learned, with a pipe, we can do this:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="manipulate-tidyr-dplyr.html#cb13-1"></a>gapminder <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(year, lifeExp)</span></code></pre></div>
<p>Let’s write it again but using multiple lines so it’s nicer to read. And let’s add a second pipe operator to pipe through <code>head</code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="manipulate-tidyr-dplyr.html#cb14-1"></a>gapminder <span class="op">%&gt;%</span></span>
<span id="cb14-2"><a href="manipulate-tidyr-dplyr.html#cb14-2"></a><span class="st">  </span><span class="kw">select</span>(year, lifeExp) <span class="op">%&gt;%</span></span>
<span id="cb14-3"><a href="manipulate-tidyr-dplyr.html#cb14-3"></a><span class="st">  </span><span class="kw">head</span>(<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## # A tibble: 4 x 2
##    year lifeExp
##   &lt;int&gt;   &lt;dbl&gt;
## 1  1952    28.8
## 2  1957    30.3
## 3  1962    32.0
## 4  1967    34.0</code></pre>
<p>Think: “Take <code>gapminder</code>, then select the variables year and lifeExp, then show the first 4 rows.”</p>
</div>
<div id="revel-in-the-convenience" class="section level2">
<h2><span class="header-section-number">2.5</span> Revel in the convenience</h2>
<p>Let’s do a little analysis where we calculate the mean gdp for Cambodia.</p>
<p>Here’s the gapminder data for Cambodia, but only certain variables:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="manipulate-tidyr-dplyr.html#cb16-1"></a>gapminder <span class="op">%&gt;%</span></span>
<span id="cb16-2"><a href="manipulate-tidyr-dplyr.html#cb16-2"></a><span class="st">  </span><span class="kw">filter</span>(country <span class="op">==</span><span class="st"> &quot;Cambodia&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb16-3"><a href="manipulate-tidyr-dplyr.html#cb16-3"></a><span class="st">  </span><span class="co"># select(country, year, pop, gdpPercap) ## entering 4 of the 6 columns is tedious</span></span>
<span id="cb16-4"><a href="manipulate-tidyr-dplyr.html#cb16-4"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>continent, <span class="op">-</span>lifeExp) <span class="co"># you can use - to deselect columns</span></span></code></pre></div>
<p>and what a typical base R call would look like:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="manipulate-tidyr-dplyr.html#cb17-1"></a>gapminder[gapminder<span class="op">$</span>country <span class="op">==</span><span class="st"> &quot;Cambodia&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;country&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;pop&quot;</span>, <span class="st">&quot;gdpPercap&quot;</span>)]</span></code></pre></div>
<pre><code>## # A tibble: 12 x 4
##    country   year      pop gdpPercap
##    &lt;fct&gt;    &lt;int&gt;    &lt;int&gt;     &lt;dbl&gt;
##  1 Cambodia  1952  4693836      368.
##  2 Cambodia  1957  5322536      434.
##  3 Cambodia  1962  6083619      497.
##  4 Cambodia  1967  6960067      523.
##  5 Cambodia  1972  7450606      422.
##  6 Cambodia  1977  6978607      525.
##  7 Cambodia  1982  7272485      624.
##  8 Cambodia  1987  8371791      684.
##  9 Cambodia  1992 10150094      682.
## 10 Cambodia  1997 11782962      734.
## 11 Cambodia  2002 12926707      896.
## 12 Cambodia  2007 14131858     1714.</code></pre>
<p>or, possibly?, a nicer look using base R’s <code>subset()</code> function:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="manipulate-tidyr-dplyr.html#cb19-1"></a><span class="kw">subset</span>(gapminder, country <span class="op">==</span><span class="st"> &quot;Cambodia&quot;</span>, <span class="dt">select =</span> <span class="kw">c</span>(country, year, pop, gdpPercap))</span></code></pre></div>
<pre><code>## # A tibble: 12 x 4
##    country   year      pop gdpPercap
##    &lt;fct&gt;    &lt;int&gt;    &lt;int&gt;     &lt;dbl&gt;
##  1 Cambodia  1952  4693836      368.
##  2 Cambodia  1957  5322536      434.
##  3 Cambodia  1962  6083619      497.
##  4 Cambodia  1967  6960067      523.
##  5 Cambodia  1972  7450606      422.
##  6 Cambodia  1977  6978607      525.
##  7 Cambodia  1982  7272485      624.
##  8 Cambodia  1987  8371791      684.
##  9 Cambodia  1992 10150094      682.
## 10 Cambodia  1997 11782962      734.
## 11 Cambodia  2002 12926707      896.
## 12 Cambodia  2007 14131858     1714.</code></pre>
</div>
<div id="use-mutate-to-add-new-variables" class="section level2">
<h2><span class="header-section-number">2.6</span> Use <code>mutate()</code> to add new variables</h2>
<p>Imagine we wanted to recover each country’s GDP. After all, the Gapminder data has a variable for population and GDP per capita. Let’s add a new column and multiply them together.</p>
<p>Visually, we are doing this (thanks RStudio for your <a href="http://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf">cheatsheet</a>):</p>
<p><img src="figs/rstudio-cheatsheet-mutate.png" /></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="manipulate-tidyr-dplyr.html#cb21-1"></a>gapminder <span class="op">%&gt;%</span></span>
<span id="cb21-2"><a href="manipulate-tidyr-dplyr.html#cb21-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">gdp =</span> pop <span class="op">*</span><span class="st"> </span>gdpPercap)</span></code></pre></div>
<blockquote>
<p>Exercise: how would you add that to the previous <code>filter</code> and <code>select</code> commands we did with Cambodia:</p>
</blockquote>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="manipulate-tidyr-dplyr.html#cb22-1"></a>gapminder <span class="op">%&gt;%</span></span>
<span id="cb22-2"><a href="manipulate-tidyr-dplyr.html#cb22-2"></a><span class="st">  </span><span class="kw">filter</span>(country <span class="op">==</span><span class="st"> &quot;Cambodia&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb22-3"><a href="manipulate-tidyr-dplyr.html#cb22-3"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>continent, <span class="op">-</span>lifeExp)</span></code></pre></div>
<p>Answer:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="manipulate-tidyr-dplyr.html#cb23-1"></a>gapminder <span class="op">%&gt;%</span></span>
<span id="cb23-2"><a href="manipulate-tidyr-dplyr.html#cb23-2"></a><span class="st">  </span><span class="kw">filter</span>(country <span class="op">==</span><span class="st"> &quot;Cambodia&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb23-3"><a href="manipulate-tidyr-dplyr.html#cb23-3"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>continent, <span class="op">-</span>lifeExp) <span class="op">%&gt;%</span></span>
<span id="cb23-4"><a href="manipulate-tidyr-dplyr.html#cb23-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">gdp =</span> pop <span class="op">*</span><span class="st"> </span>gdpPercap)</span></code></pre></div>
</div>
<div id="group_by-and-summarize" class="section level2">
<h2><span class="header-section-number">2.7</span> <code>group_by</code> and <code>summarize</code></h2>
<p>Great! And now we want to calculate the mean gdp across all years (Let’s pretend that’s a good idea statistically)</p>
<p>Visually, we are doing this (thanks RStudio for your <a href="http://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf">cheatsheet</a>):</p>
<p><img src="figs/rstudio-cheatsheet-summarise.png" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="manipulate-tidyr-dplyr.html#cb24-1"></a>gapminder <span class="op">%&gt;%</span></span>
<span id="cb24-2"><a href="manipulate-tidyr-dplyr.html#cb24-2"></a><span class="st">  </span><span class="kw">filter</span>(country <span class="op">==</span><span class="st"> &quot;Cambodia&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb24-3"><a href="manipulate-tidyr-dplyr.html#cb24-3"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>continent, <span class="op">-</span>lifeExp) <span class="op">%&gt;%</span></span>
<span id="cb24-4"><a href="manipulate-tidyr-dplyr.html#cb24-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">gdp =</span> pop <span class="op">*</span><span class="st"> </span>gdpPercap) <span class="op">%&gt;%</span></span>
<span id="cb24-5"><a href="manipulate-tidyr-dplyr.html#cb24-5"></a><span class="st">  </span><span class="kw">group_by</span>(country) <span class="op">%&gt;%</span></span>
<span id="cb24-6"><a href="manipulate-tidyr-dplyr.html#cb24-6"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_gdp =</span> <span class="kw">mean</span>(gdp)) <span class="op">%&gt;%</span></span>
<span id="cb24-7"><a href="manipulate-tidyr-dplyr.html#cb24-7"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="co"># if you use group_by, also use ungroup() to save heartache later</span></span></code></pre></div>
</div>
<div id="remember-our-for-loop" class="section level2">
<h2><span class="header-section-number">2.8</span> Remember our for loop?</h2>
<p>And how would you then do this for every country, not just Cambodia? Well, yesterday we would have been thinking about putting this whole analysis inside a for loop, replacing “Cambodia” with a new name each time we iterated through the loop. But today, we have it already, just need to <em>delete</em> one line from our analysis–we don’t need to filter out Cambodia anymore!!</p>
<p>Visually, we are doing this (thanks RStudio for your <a href="http://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf">cheatsheet</a>):</p>
<p><img src="figs/rstudio-cheatsheet-group_by.png" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="manipulate-tidyr-dplyr.html#cb25-1"></a>gapminder <span class="op">%&gt;%</span></span>
<span id="cb25-2"><a href="manipulate-tidyr-dplyr.html#cb25-2"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>continent, <span class="op">-</span>lifeExp) <span class="op">%&gt;%</span></span>
<span id="cb25-3"><a href="manipulate-tidyr-dplyr.html#cb25-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">gdp =</span> pop <span class="op">*</span><span class="st"> </span>gdpPercap) <span class="op">%&gt;%</span></span>
<span id="cb25-4"><a href="manipulate-tidyr-dplyr.html#cb25-4"></a><span class="st">  </span><span class="kw">group_by</span>(country) <span class="op">%&gt;%</span></span>
<span id="cb25-5"><a href="manipulate-tidyr-dplyr.html#cb25-5"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_gdp =</span> <span class="kw">mean</span>(gdp)) <span class="op">%&gt;%</span></span>
<span id="cb25-6"><a href="manipulate-tidyr-dplyr.html#cb25-6"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="co"># if you use group_by, also use ungroup() to save heartache later</span></span></code></pre></div>
<p>So we have done a pretty incredible amount of work in a few lines. Our whole analysis is this. Imagine the possibilities from here.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="manipulate-tidyr-dplyr.html#cb26-1"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb26-2"><a href="manipulate-tidyr-dplyr.html#cb26-2"></a></span>
<span id="cb26-3"><a href="manipulate-tidyr-dplyr.html#cb26-3"></a>gapminder <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-4"><a href="manipulate-tidyr-dplyr.html#cb26-4"></a><span class="st">  </span><span class="kw">read.csv</span>(<span class="st">&#39;data/gapminder-FiveYearData.csv&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-5"><a href="manipulate-tidyr-dplyr.html#cb26-5"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>continent, <span class="op">-</span>lifeExp) <span class="op">%&gt;%</span></span>
<span id="cb26-6"><a href="manipulate-tidyr-dplyr.html#cb26-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">gdp =</span> pop <span class="op">*</span><span class="st"> </span>gdpPercap) <span class="op">%&gt;%</span></span>
<span id="cb26-7"><a href="manipulate-tidyr-dplyr.html#cb26-7"></a><span class="st">  </span><span class="kw">group_by</span>(country) <span class="op">%&gt;%</span></span>
<span id="cb26-8"><a href="manipulate-tidyr-dplyr.html#cb26-8"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_gdp =</span> <span class="kw">mean</span>(gdp)) <span class="op">%&gt;%</span></span>
<span id="cb26-9"><a href="manipulate-tidyr-dplyr.html#cb26-9"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="co"># if you use group_by, also use ungroup() to save heartache later</span></span></code></pre></div>
</div>
<div id="summary" class="section level2">
<h2><span class="header-section-number">2.9</span> Summary</h2>
<p>This has been the ‘Tranform’ or Wrangling part of this cycle.</p>
<p><img src="figs/r4ds_data-science.png" /></p>
<p>Importing and tidying is also a HUGE part of this process, and we don’t have time to get into it today. But look at the cheatsheet, and watch the webinar. <a href="http://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf">cheatsheet</a> and <a href="https://www.rstudio.com/resources/webinars/data-wrangling-with-r-and-rstudio/">webinar</a>. Watch this 1 hour webinar and follow along in RStudio and your science will be forever changed. Again!</p>
<p><img src="figs/rstudio-cheatsheet-reshaping-data.png" /></p>
<hr />
</div>
<div id="further-materials-as-reference" class="section level2">
<h2><span class="header-section-number">2.10</span> Further materials as reference…</h2>
<div id="rationale" class="section level3">
<h3><span class="header-section-number">2.10.1</span> Rationale</h3>
<p>When performing data analysis in R, code can become quite messy, making it hard to revisit and determine the sequence of operations. Commenting helps. Good variable names help. Still, at least two common issues make code difficult to understand: <strong>multiple variables</strong> and <strong>nested functions</strong>. Let’s examine these issues by approaching an analysis presenting both problems, and finally see how <code>dplyr</code> offers an elegant alternative.</p>
<p>For example, let’s ask of the <code>surveys.csv</code> dataset: <em><strong>How many observations of a certain thing you’re interested in appear each year?</strong></em></p>
</div>
<div id="pseudocode" class="section level3">
<h3><span class="header-section-number">2.10.2</span> Pseudocode</h3>
<p>You can write the logic out as <strong>pseudocode</strong> which can become later comments for the actual code:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="manipulate-tidyr-dplyr.html#cb27-1"></a><span class="co"># read in csv</span></span>
<span id="cb27-2"><a href="manipulate-tidyr-dplyr.html#cb27-2"></a><span class="co"># view data</span></span>
<span id="cb27-3"><a href="manipulate-tidyr-dplyr.html#cb27-3"></a><span class="co"># limit columns to species and year</span></span>
<span id="cb27-4"><a href="manipulate-tidyr-dplyr.html#cb27-4"></a><span class="co"># limit rows to just species &quot;NL&quot;</span></span>
<span id="cb27-5"><a href="manipulate-tidyr-dplyr.html#cb27-5"></a><span class="co"># get count per year</span></span>
<span id="cb27-6"><a href="manipulate-tidyr-dplyr.html#cb27-6"></a><span class="co"># write out csv</span></span></code></pre></div>
</div>
<div id="summary-1" class="section level3">
<h3><span class="header-section-number">2.10.3</span> Summary</h3>
<p>The <code>tidyr</code> and <code>dplyr</code> packages were created by <a href="https://github.com/hadley">Hadley Wickham</a> of <code>ggplot2</code> fame. The “gg” in <code>ggplot2</code> stands for the “grammar of graphics”. Hadley similarly considers the functionality of the two packages <code>dplyr</code> and <code>tidyr</code> to provide the “grammar of data manipulation”.</p>
<p>Next, we’ll explore the data wrangling lessons that <a href="https://github.com/swcarpentry/r-novice-gapminder/commits?author=remi-daigle">Remi contributed</a> to Software Carpentry.</p>
</div>
<div id="dplyr" class="section level3">
<h3><span class="header-section-number">2.10.4</span> <code>dplyr</code></h3>
<p><a href="http://swcarpentry.github.io/r-novice-gapminder/13-dplyr.html"><strong>dplyr</strong> - Software Carpentry</a></p>
</div>
<div id="tidyr" class="section level3">
<h3><span class="header-section-number">2.10.5</span> <code>tidyr</code></h3>
<p><a href="http://swcarpentry.github.io/r-novice-gapminder/14-tidyr.html"><strong>tidyr</strong> - Software Carpentry</a></p>
</div>
<div id="other-links" class="section level3">
<h3><span class="header-section-number">2.10.6</span> Other links</h3>
<ul>
<li><a href="http://ucsb-bren.github.io/env-info/wk04_tidyr.html">Tidying up Data - Env Info</a> - <a href="https://github.com/ucsb-bren/env-info/blob/gh-pages/wk04_tidyr.Rmd">Rmd</a></li>
<li><a href="http://bbest.github.io/dplyr-tidyr-tutorial/">Data wrangling with dplyr and tidyr - Tyler Clavelle &amp; Dan Ovando</a> - <a href="https://github.com/bbest/dplyr-tidyr-tutorial/blob/gh-pages/index.Rmd">Rmd</a></li>
</ul>

</div>
</div>
</div>
<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/lesson.js"></script>
            </section>

          </div>
        </div>
      </div>
<a href="collaborate-git-github.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="visualize-ggplot2-plotly-tmap.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ecoquants/r3-workshop/blob/master/02_wrangle.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["r3-workshop.pdf"],
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

</body>

</html>
